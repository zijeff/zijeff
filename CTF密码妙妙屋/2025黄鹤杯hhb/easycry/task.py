#!/usr/bin/env python3
from  random import *
from secret import FLAG
from Crypto.Util.number import *



m = bytes_to_long(FLAG)
a = [35,51,91,115,123,187,235,267,403,427]
D = choice(a)
while True:
    V = getRandomInteger(2 ** 2048)
    numbers = D * V ** 2 + 1
    if numbers % 4 == 0:
        p = numbers // 4
        if isPrime(p):
            q = getPrime(2048)
            n = p * q
            e = 0x10001
            c = pow(m, e, n)
            print(f"n : {n}","\n",f"e : {e}","\n",f"c : {c}")
            exit(0)
        else:
            print("numbers is not Prime!!!")
    else:
        print("It is not divisible by 4!!!")

      
# n : 404346648884597392605186375266254608649029175749025041311837330226523951380438816899580202048378908742814874153913081850066981021681949387875292053626788162948768889577117691921764786649412518087820362752090144069799045650706666541753120112708078914947299130801107134679432427667077893195345985056151062828188286901067724903830851410360396781111355290705021857613616717153933295263748265273164410819614021366920649837245670830338768555276561832467231485276869038117956933374984985391439855351449732597447804319032602280378261379721623867107254208096171778176518716445122699073475371662726449266915661919213790336664037723748275174633678518215591678617518596185895050893155749090148764342061102700263817455924583481055968619397624336871688495386566620206402698583647373521356152369317757009864876220991658527727687091920103260006624596861448704791961989352239282402333353751615431119565492068541681690066537776509460887031172075008361291074011597869706212760205400756854397344460880422800109964921113312876784750556152575069062299599305531272488454700401123289608535234753660854032419603223442797680605371354832525209828296329631613909574938905108585974691864490395385545086757093590596299139431863539103513806451598705641113210996323741276674714596960638509198166737848661721418002037773417867188268740270930169315142845925308755907322282700061823678558777025896252709719281538126072212270217861897296387535436208198633419038655256868764842922566790109305353071860437495907787471890392990733885985345069948273829613023679827159075446520212863573178949020931438432067035452016683867158983328997529082261162959770260423931085686734064286368639863494845591021903776036861931271649104146718210847571234532059095631058979940977752950022688882413664773583165622687611209696750371602428089124969102738112146929576825130445265527821371219399545644671814366439
# e : 65537
# c : 200506471245759116218944236826951456229937237079491847638905898660794153793174301327561439340727216151692501819649555776877455133858975494010729270279321858081300832922596914174909214997754292519947482698129223807826157130943209699846827041618665211842850304816275392362038723335335269838765113106120015014083756334297576362364972010066835174938793635509309404689742934219885447156520641745323059497999441254378107328482527774532211902133671573987413616932756668046850718306864812352198433921822678686993323382191939196468627211543646295991562497704004994051773882230269999602958063870715277550297103177852119459463712830025310906919855834367968533595166890633326255988819353170496377184216912767894254025307057838036375097560282924514586004232129667833630129037311893318556499621910791632768890913725166469890753834984674158250696229592964598276669628883352839844826520542179083229018905934699199213277789086813198559991933986198593127223519190570567263419505621950251423094655120892279437816629013745131471700638408255700682018141435272496223049884996575081254012177899324232397428787531607544214740005071580252503331989090191017396736289028852760653438366528005343085691933452229742873298471742531488122757015162491059973759570050004542409225283898820744366964192068845150066282914116383250673936003762267679476084019554129528831041554893092112595532778424733345636592563898353714826161452521641824711349314775065078069140290238721985881231311896538452405676616333937986591138856468593648147318839175645505964124317315704437581154002936424599695702324256421033267567287675957376485447926783487247207790147409386987140805698127602875713148639293384597892452878373376000372636924534266102332626699341557403230993285111616452627011396604930510478830008973280855649985895827200983449631116634923475204402443272176686788976697685243905602872252605926152
